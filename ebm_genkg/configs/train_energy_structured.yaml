# run with:
# python scripts/train_energy_structured.py --config configs/train_energy_structured.yaml

in_npz: /home/code/3Ddetection/IS-Fusion/GenKG/ebm_genkg/experiments/tmp/trainset.npz
out_ckpt: /home/code/3Ddetection/IS-Fusion/GenKG/ebm_genkg/checkpoints/energy_structured.json
out_summary: /home/code/3Ddetection/IS-Fusion/GenKG/ebm_genkg/checkpoints/energy_structured.summary.json

val_ratio: 0.2
seed: 42
split_by: scene
normalize: true

hidden_dim: 64
epochs: 8
batch_size: 32768
lr: 0.001
weight_decay: 1.0e-6
max_train_rows: null
device: cpu

pos_weight_mode: auto
pos_weight: 1.0
threshold_metric: f2
threshold_grid: "0.15,0.20,0.25,0.30,0.35,0.40,0.45,0.50"

struct_weight: 1.0
struct_margin: 1.0
struct_frames_per_step: 4
struct_max_cands_per_frame: 64
pair_radius: 2.5
pair_max_neighbors: 12
pair_cache_max_frames: 512
pair_energy_scale: 1.0

# stage-2 aligned structured targets
raw_pos_score_thr: 0.30
neg_warp_gain_thr: 0.0
neg_dup_thr: 0.55
neg_score_thr: 0.35
neg_reg_weight: 0.30
pair_sup_weight: 0.20
pair_conflict_overlap_thr: 0.55
pair_conflict_close_thr: 0.60
pair_conflict_dup_thr: 0.55
pair_conflict_weight: 2.0
target_recall: 0.75
target_select_metric: precision
